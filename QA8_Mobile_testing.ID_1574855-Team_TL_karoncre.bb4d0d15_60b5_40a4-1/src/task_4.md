## Логи и логирование

**Логи** – это записи либо сообщения в виде текста. В этом тексте записываются все действия пользователя или как отвечает система на действия пользователя, соответственно, вся та информация, что вы делаете, куда нажимаете на самом устройстве, в приложении – всё это пишется в логи.

### Уровни логирования

|Уровень|Описание|Пример|
| :- | :- | :- |
|**Error**|Ошибки, которые говорят о работе системы, на них надо очень быстро реагировать и всегда сообщать о них разработчикам. Сообщения об ошибках, в рамках андроид разработки этот уровень присваивается как фатальным ошибкам приводящим к крашу приложения, так и к ошибкам, которые были перехвачены при обработке в try catch и не вызвали краша.|<p>*SpannableStringBuilder* – это ошибка приложения, которая говорит нам о том, что текстовое поле, то есть Span, наш элемент, он не может быть нулевым либо пустым. </p><p>*ZeroHung* - это системная ошибка. Данная ошибка говорит о том, что у нас происходит утечка памяти, она может быть как от какого-то действия с приложением, так и от самого приложения.</p>|
|**Warning**|Предупреждения о потенциальных проблемах, которые не приводят к крашу приложения, но могут вызвать нежелательное поведение.|<p>Ошибка из приложения: мы пытаемся декодировать видео в нужное нам качество, в нужный формат, и у нас на этом происходит ошибка.</p><p>*BroadcastQueue* - это ошибка системная, ошибка работы какого-то виджета на вашем устройстве.</p>|
|**Info**|Уровень логов, на котором приходят записи чисто информационного характера о работе системы.|Действия пользователя (нажатие на кнопку, загрузка файла), успешное подключение к базе данных. |
|**Debug**|Уровень сообщений, в котором передается информация о процессах отладки или шаги каких-то крупных процессов, то, на что разработчики хотели обратить пристальное внимание. |<p>*MediaSessionService: dispatchVolumeKeyEvent* - пользователь нажимал на кнопку уменьшения или увеличения громкости.</p><p>Если приложение использует сокет-сессию, то на уровне DEBUG можем увидеть, когда сессия начинается и заканчивается:</p><p>*b$b: WebSocket connected*.</p>|
|**Verbose**|Сообщения такого уровня уточняют или раскрывают действия. Используется этот уровень, когда нужно увидеть абсолютно всё, что происходит в вашем коде.|<p>При включении геолокации в записи отобразится текущая геолокация:</p><p>*GnssLocationProvider: reportLocation Location [...]*.</p>|

### Типы логов

**Системные логи (System Logs)**

Создаются операционной системой и содержат информацию о её работе, включая запуск и завершение процессов, ошибки файловой системы и другие события. Они помогают отслеживать работу приложения на уровне операционной системы и выявлять проблемы, связанные с конфигурацией или взаимодействием с другими приложениями.

**Логи приложения (Application Logs)**

Создаются самим приложением и содержат информацию о его работе: сообщения об ошибках, предупреждения и информацию о выполненных действиях. Такие логи помогают выявлять и исправлять ошибки в приложении, а также понимать его внутреннее состояние и последовательность действий.

**Логи сервера (Server Logs)**

Содержат информацию о запросах к серверу и других событиях, происходящих на сервере. Серверные логи отслеживают взаимодействие приложения с сервером, выявляют проблемы с производительностью и обрабатываемостью запросов.

**Логи баз данных (Database Logs)**

Содержат информацию о выполняемых запросах к базе данных, изменениях данных и других событиях. Такие логи помогают отслеживать выполнение запросов, выявлять проблемы с производительностью и целостностью данных.

**Логи сетевых устройств (Network Device Logs)**

Содержат хронологические записи о событиях, происходящих на сетевом оборудовании  (маршрутизаторами, коммутаторами, межсетевыми экранами (файрволами), VPN-концентраторами). Изменения конфигурации, статус интерфейсов (up/down), статистика трафика, события безопасности срабатывания правил файрвола (разрешённый/заблокированный трафик).

**Логи безопасности (Security Logs / Audit Logs)**

Содержат попытки входа (успешные и неуспешные), изменение прав доступа, запуск аудируемых команд, доступ к конфиденциальным данным. Специализированные логи, которые фиксируют события, связанные с безопасностью. Используются для аудита, расследования инцидентов и соответствия стандартам (GDPR, PCI DSS).

*Дополнительно для удобства обработки логи делятся на подтипы:*

- системные, связанные с системными событиями;

- серверные, отвечающие за процесс обращения к серверу;

- почтовые, работающие с отправлениями;

- логи баз данных, которые отражают процессы обращения к базам данных;

- авторизационные и аутентификационные, которые отвечают за процесс входа‑выхода из системы, восстановление доступа и т. д.

### Механизмы записи логов

В журналах логов не фиксируется абсолютно вся информация. Система производит запись наиболее важных для анализа данных. При обращении пользователя к конкретной странице сайта, в лог записываются: URL, к которому обращается посетитель, его IP-адрес, используемый браузер, операционная система, дата и точное время обращения, код ответа сервера и прочее.  
1. **Занесение лога в текстовый документ.** Это наиболее распространенный вариант. Он подход для логирования всех уровней. Такие журналы очень легко читать. Логи здесь представлены в виде обычного текста.  
1. **Запись события в несколько строк**. Этот вариант формирования лога более глубокий и сложный. В качестве примера стоит привести журнал ошибок. В них логи поддерживают многоступенчатую структуру. Значимые сведения из-за этого человек может пропустить. Ввиду соответствующей особенности при формировании лога «в несколько строк» необходимо использовать специальное программное обеспечение.  
1. **Бинарные записи**. Наиболее сложный вариант формирования лога. Они обрабатываются тем же программным обеспечением, что и программы, их записывающие. Журналы будут представлены двоичными кодами.  
1. **Приложения, использующие БД или сами СУБД**. Такой вариант создания логов имеет недостаток в виде вероятности замедления работы информационной базы. Оно вызвано интенсивной записью событий. При использовании соответствующего механизма формирования лога необходимо досконально прописать, что именно требуется фиксировать.
